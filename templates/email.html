{% load static %}
{% static "images" as baseUrl %}

<!doctype html>
<html lang="en">
{% include 'header.html' %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<body>
    <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
            <div class="site-mobile-menu-close mt-3">
                <span class="icon-close2 js-menu-toggle"></span>
            </div>
        </div>
        <div class="site-mobile-menu-body">
        </div>
    </div>
    {% include 'banner.html' %}
    <div class="container my-4">
        <div class="row" style="margin:0px;">
            <video src="{% static '/images/Cryptoshare_PAY.mp4' %}" id="cs_pay"
            style="margin-left:auto;margin-right:auto;zoom:85%;max-width: 100vw;" autoplay loop muted playsinline>
        </div>
        <script> $( window ).load(function() { $('#cs_pay').get(0).play();}); </script>
    </div>
    <div class="container my-4">
        <h4 style="text-align:center ;">Already have an Account? <a href="{% url 'authentication:Login' %}">Login here!</a></h4>
        <div class="row">
            <div class="card container1" style="max-width: 600px;">
                {% include 'messages.html' %}
                <form method="POST">
                    {% csrf_token %}
                    <h2 class="text-primary" style="text-align:center;">Create your Crypto$hare Account</h2>
                    <br>
                    <div class="form-row">
                        <div class="form-group col-12">
                            <label for="email">Enter your email:</label>
                            <input type="email" class="form-control" name="email" id="email" placeholder="email@example.com" required maxlength="50">
                            <p style="text-align: center; color:black;"><small>
                                Your email will be used to log in.
                            </small></p>
                        </div>
                        
                        <div class="form-group col-md-6">
                            <label for="fname">First name:</label>
                            <input type="text" class="form-control" name="fname" id="fname"
                            required maxlength="30">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="lname">Last name:</label>
                            <input type="text" class="form-control" name="lname" id="lname"
                            required maxlength="30">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="pin">Create 6 Digit PIN Code:</label>
                            <input type="password"  onpaste="return false;" onkeypress="return ((event.charCode <= 57 && event.charCode >= 48) || (event.charCode ==0 && event.charCode !=8))" class="form-control" name="pin" id="pin"
                            required pattern="[0-9]{6}" maxlength="6" minlength="6">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="conf_pin">Confirm 6 Digit PIN Code:</label>
                            <input type="password"  onpaste="return false;" onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))" class="form-control" name="conf_pin" id="conf_pin"
                            required pattern="[0-9]{6}" maxlength="6" minlength="6">
                        </div>
                        <div id="toggle-pin"><input type="checkbox" onclick="togglePINVis()"> Show PIN</div>
                        <div class="form-row col-12">
                            <div id='pin_match'></div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <!-- Referral Code Feature not added yet!--> 
                        <div class="form-group col-12">
                            <label for="conf_phone">Enter Referral code:</label>
                            <input type="text" class="form-control" name="ref_code" id="ref_code"
                            placeholder="Referral code (Coming Soon!)" disabled
                            pattern="^\d{3}-\d{3}$">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary" id="submit" disabled>Submit</button>
                </form>
                <br>
                <a href="{% url 'authentication:Home' %}"><button type="submit"
                    class="btn btn-primary">Back</button>
                </a>
            </div>
        </div>
    </div>
    {% include 'info_card.html' %}
    
    <!-- STARTING GENIUS REFERRALS TRACKING CODE -->
    <script type="text/javascript">
        !function (){
            const submit = function (e){
                const grFirstName=document.getElementsByName("fname")[0].value,
                grLastName=document.getElementsByName("lname")[0].value,
                grEmail=document.getElementsByName("email")[0].value,
                grMetadata='['+']';
                if (grEmail != '') {
                    e.preventDefault();
                    const grSetting={
                        "grTemplateSlug": "advocate-portal-280",
                        "grCustomerFirstname": grFirstName,
                        "grCustomerLastname": grLastName,
                        "grCustomerEmail": grEmail,
                        "grMetadata": grMetadata,
                        "grCustomerCurrencyCode": "USD", /** your customers currency code **/
                        "grCanRefer": "false",
                        "grReference" : "1643387502" /** could be the order id, timestamp, etc. **/
                    }
                    const button = this;
                    GRToolbox.processCustomerAndBonus(grSetting).then(function(){
                        button.onclick=function(){};button.click();});}};
                        const grSettingCookie={
                            "grCookieLifeTime": "180",
                        },
                        e=window,t=document;e.addEventListener("load",function(){const e=t.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://e9f87d8c82343264e6ba-2977c39e5e9390b1a89ab5ed2a171102.ssl.cf1.rackcdn.com/toolbox/geniusreferrals-toolbox_3.3.1.min.js",e.onload=function(){GRToolbox.catchReferrer(grSettingCookie);t.getElementById("submit").onclick = submit;};const n=t.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)},!1)}();
                    </script>
                    <!-- ENDING GENIUS REFERRALS TRACKING CODE -->
                    
                    <script type="text/javascript">
                        // toggle PIN visibility
                        function togglePINVis() {
                            var button = document.getElementById("pin");
                            var button2 = document.getElementById("conf_pin");
                            if (button.type == 'password') {
                                button.type = 'text';
                                button2.type = 'text';
                            } else {
                                button.type = 'password';
                                button2.type = 'password';
                            }
                        }
                        // set PIN matching text
                        $('#pin, #conf_pin').on('keyup', function () {
                            if (($('#pin').val().length == 0) || ($('#conf_pin').val().length==0)) {
                                $('#pin_match').html('');
                            }
                            else if ($('#pin').val() == $('#conf_pin').val())
                            {
                                if (($('#pin').val().length == 6) & ($('#conf_pin').val().length==6)) {
                                    $('#pin_match').html('PINs match!').css('color', 'green');
                                    $('#submit').prop('disabled', false);
                                }
                                else {
                                    $('#pin_match').html('PIN must be 6 digits.').css('color', 'red');
                                    $('#submit').prop('disabled', true);
                                }
                            }
                            else {
                                $('#pin_match').html('PINs do not match.').css('color', 'red');
                                $('#submit').prop('disabled', true);
                            }
                        });
                        function googleTranslateElementInit() {
                            new google.translate.TranslateElement({
                                pageLanguage: 'en',
                                autoDisplay: false
                            }, 'google_translate_element'); //remove the layout
                        }
                    </script>
                    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" type="text/javascript">
                    </script>
                    <script type="text/javascript">
                        function triggerHtmlEvent(element, eventName) {
                            var event;
                            if (document.createEvent) {
                                event = document.createEvent('HTMLEvents');
                                event.initEvent(eventName, true, true);
                                element.dispatchEvent(event);
                            } else {
                                event = document.createEventObject();
                                event.eventType = eventName;
                                element.fireEvent('on' + event.eventType, event);
                            }
                        }
                        
                        $('.translation-links a').click(function (e) {
                            e.preventDefault();
                            var lang = $(this).data('lang');
                            $('#google_translate_element select option').each(function () {
                                if ($(this).text().indexOf(lang) > -1) {
                                    $(this).parent().val($(this).val());
                                    var container = document.getElementById('google_translate_element');
                                    var select = container.getElementsByTagName('select')[0];
                                    triggerHtmlEvent(select, 'change');
                                }
                            });
                        });
                    </script>
                    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
                    <script src="{% static 'js/popper.min.js' %}"></script>
                    <script src="{% static 'js/bootstrap.min.js' %}"></script>
                    <script src="{% static 'js/jquery.sticky.js' %}"></script>
                    <script src="{% static 'js/main.js' %}"></script>
                    {% include 'footer.html' %}
                </body>
                </html>
                